<div
  class="p-6 bg-white border border-light-gray rounded space-y-4"
  (drop)="onDrop($event)"
  (dragover)="$event.preventDefault()"
>
  <div
    role="radiogroup"
    aria-label="Tipo"
    class="flex border border-aluminium rounded overflow-hidden divide-x divide-aluminium text-sm"
  >
    <label
      class="px-3 py-1 cursor-pointer focus-within:ring-2 focus-within:ring-hydro-light-blue flex-1 text-center"
      [class.bg-hydro-blue]="type === 'ANNOTATION'"
      [class.text-white]="type === 'ANNOTATION'"
      [ngClass]="{
        'hover:bg-hydro-dark-blue': type === 'ANNOTATION',
        'hover:bg-light-gray': type !== 'ANNOTATION'
      }"
    >
      <input
        class="sr-only"
        type="radio"
        name="type"
        [(ngModel)]="type"
        value="ANNOTATION"
        (ngModelChange)="saveDraft()"
      />
      Anotação
    </label>
    <label
      class="px-3 py-1 cursor-pointer focus-within:ring-2 focus-within:ring-hydro-light-blue flex-1 text-center"
      [class.bg-hydro-blue]="type === 'URGENCY'"
      [class.text-white]="type === 'URGENCY'"
      [ngClass]="{
        'hover:bg-hydro-dark-blue': type === 'URGENCY',
        'hover:bg-light-gray': type !== 'URGENCY'
      }"
    >
      <input
        class="sr-only"
        type="radio"
        name="type"
        [(ngModel)]="type"
        value="URGENCY"
        (ngModelChange)="saveDraft()"
      />
      Urgência
    </label>
    <label
      class="px-3 py-1 cursor-pointer focus-within:ring-2 focus-within:ring-hydro-light-blue flex-1 text-center"
      [class.bg-hydro-blue]="type === 'PENDENCY'"
      [class.text-white]="type === 'PENDENCY'"
      [ngClass]="{
        'hover:bg-hydro-dark-blue': type === 'PENDENCY',
        'hover:bg-light-gray': type !== 'PENDENCY'
      }"
    >
      <input
        class="sr-only"
        type="radio"
        name="type"
        [(ngModel)]="type"
        value="PENDENCY"
        (ngModelChange)="saveDraft()"
      />
      Pendência
    </label>
  </div>

  <div class="border border-light-gray rounded" (paste)="onPaste($event)">
    <quill-editor
      #editor
      [(ngModel)]="content"
      [modules]="modules"
      format="html"
      (ngModelChange)="saveDraft()"
      placeholder="Escreva uma atualização do turno… Ex.: status de produção, ocorrências, apontamentos"
      class="min-h-[120px]"
    ></quill-editor>
  </div>

  <div *ngIf="attachments.length" class="space-y-2">
    <div *ngFor="let att of attachments" class="flex items-center gap-2">
      <img *ngIf="att.url" [src]="att.url" alt="Pré-visualização" class="w-16 h-16 object-cover rounded" />
      <span class="text-sm">{{ att.file.name }} ({{ att.file.size / 1024 | number:'1.0-0' }} KB)</span>
      <button type="button" (click)="removeAttachment(att)" class="text-hydro-blue text-sm underline">Remover</button>
    </div>
  </div>

  <div class="flex items-center gap-4">
    <label class="cursor-pointer text-hydro-blue flex items-center gap-1 hover:underline">
      <input type="file" multiple class="hidden" (change)="onFileInput($event)" />
      <span>Anexar arquivos</span>
    </label>
    <button
      type="button"
      (click)="publish()"
      [disabled]="sending"
      class="px-4 py-2 rounded bg-hydro-blue hover:bg-hydro-dark-blue text-white disabled:opacity-50"
    >
      {{ sending ? 'Publicando…' : 'Publicar' }}
    </button>
    <span
      *ngIf="message"
      class="text-sm"
      [class.text-bauxite]="message.startsWith('Falha')"
      [class.text-green]="message.startsWith('Publicação')"
      >{{ message }}</span
    >
  </div>
</div>
