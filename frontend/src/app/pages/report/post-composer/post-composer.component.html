<div
  class="p-6 bg-white border border-light-gray rounded space-y-4"
  (drop)="onDrop($event)"
  (dragover)="$event.preventDefault()"
>
  <div
    role="radiogroup"
    aria-label="Tipo"
    class="flex border border-aluminium rounded overflow-hidden divide-x divide-aluminium text-sm"
  >
    <label
      class="px-3 py-1 cursor-pointer focus-within:ring-2 focus-within:ring-hydro-light-blue flex-1 text-center"
      [class.bg-hydro-blue]="type === 'ANNOTATION'"
      [class.text-white]="type === 'ANNOTATION'"
      [ngClass]="{
        'hover:bg-hydro-dark-blue': type === 'ANNOTATION',
        'hover:bg-light-gray': type !== 'ANNOTATION'
      }"
    >
      <input
        class="sr-only"
        type="radio"
        name="type"
        [(ngModel)]="type"
        value="ANNOTATION"
        (ngModelChange)="saveDraft()"
      />
      AnotaÃ§Ã£o
    </label>
    <label
      class="px-3 py-1 cursor-pointer focus-within:ring-2 focus-within:ring-hydro-light-blue flex-1 text-center"
      [class.bg-hydro-blue]="type === 'URGENCY'"
      [class.text-white]="type === 'URGENCY'"
      [ngClass]="{
        'hover:bg-hydro-dark-blue': type === 'URGENCY',
        'hover:bg-light-gray': type !== 'URGENCY'
      }"
    >
      <input
        class="sr-only"
        type="radio"
        name="type"
        [(ngModel)]="type"
        value="URGENCY"
        (ngModelChange)="saveDraft()"
      />
      UrgÃªncia
    </label>
    <label
      class="px-3 py-1 cursor-pointer focus-within:ring-2 focus-within:ring-hydro-light-blue flex-1 text-center"
      [class.bg-hydro-blue]="type === 'PENDENCY'"
      [class.text-white]="type === 'PENDENCY'"
      [ngClass]="{
        'hover:bg-hydro-dark-blue': type === 'PENDENCY',
        'hover:bg-light-gray': type !== 'PENDENCY'
      }"
    >
      <input
        class="sr-only"
        type="radio"
        name="type"
        [(ngModel)]="type"
        value="PENDENCY"
        (ngModelChange)="saveDraft()"
      />
      PendÃªncia
    </label>
  </div>

  <div class="border border-light-gray rounded">
    <div class="flex gap-1 border-b p-1">
      <button type="button" (click)="format('bold')" aria-label="Negrito" class="px-2 py-1 hover:bg-light-gray">B</button>
      <button type="button" (click)="format('italic')" aria-label="ItÃ¡lico" class="px-2 py-1 hover:bg-light-gray"><em>I</em></button>
      <button type="button" (click)="format('insertUnorderedList')" aria-label="Lista" class="px-2 py-1 hover:bg-light-gray">â€¢</button>
      <button type="button" (click)="format('insertOrderedList')" aria-label="Lista numerada" class="px-2 py-1 hover:bg-light-gray">1.</button>
      <button type="button" (click)="formatLink()" aria-label="Link" class="px-2 py-1 hover:bg-light-gray">ðŸ”—</button>
    </div>
    <textarea
      #editor
      class="editor p-2 min-h-[120px] outline-none w-full resize-none"
      aria-label="ConteÃºdo"
      placeholder="Escreva uma atualizaÃ§Ã£o do turnoâ€¦ Ex.: status de produÃ§Ã£o, ocorrÃªncias, apontamentos"
      (input)="saveDraft()"
      (paste)="onPaste($event)"
    ></textarea>
  </div>

  <div *ngIf="attachments.length" class="space-y-2">
    <div *ngFor="let att of attachments" class="flex items-center gap-2">
      <img *ngIf="att.url" [src]="att.url" alt="PrÃ©-visualizaÃ§Ã£o" class="w-16 h-16 object-cover rounded" />
      <span class="text-sm">{{ att.file.name }} ({{ att.file.size / 1024 | number:'1.0-0' }} KB)</span>
      <button type="button" (click)="removeAttachment(att)" class="text-hydro-blue text-sm underline">Remover</button>
    </div>
  </div>

  <div class="flex items-center gap-4">
    <label class="cursor-pointer text-hydro-blue flex items-center gap-1 hover:underline">
      <input type="file" multiple class="hidden" (change)="onFileInput($event)" />
      <span>Anexar arquivos</span>
    </label>
    <button
      type="button"
      (click)="publish()"
      [disabled]="sending"
      class="px-4 py-2 rounded bg-hydro-blue hover:bg-hydro-dark-blue text-white disabled:opacity-50"
    >
      {{ sending ? 'Publicandoâ€¦' : 'Publicar' }}
    </button>
    <span
      *ngIf="message"
      class="text-sm"
      [class.text-bauxite]="message.startsWith('Falha')"
      [class.text-green]="message.startsWith('PublicaÃ§Ã£o')"
      >{{ message }}</span
    >
  </div>
</div>
